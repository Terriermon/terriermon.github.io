
 <!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  
    <title>HTTPS、SSL与TLS | 次元空间</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="terriermon">
    

    
    <meta name="description" content="首先 SSL与TLS都是一种接口标准. SSL协议 与 TLS协议 的关系 SSL 是洋文Secure Sockets Layer的缩写，中文叫做 安全套接层  SSL协议解决http协议使用明文方式传输数据，防止数据被拦截嗅探  到了1999年，SSL协议 因为应用广泛，已经成为互联网上的标准.  后来SSL协议 又被 IETF组织 标准化，标准化之后的名字叫做 TLS （Transport L">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTPS、SSL与TLS">
<meta property="og:url" content="http://yoursite.com/2017/09/19/HTTPS、SSL与TLS/index.html">
<meta property="og:site_name" content="次元空间">
<meta property="og:description" content="首先 SSL与TLS都是一种接口标准. SSL协议 与 TLS协议 的关系 SSL 是洋文Secure Sockets Layer的缩写，中文叫做 安全套接层  SSL协议解决http协议使用明文方式传输数据，防止数据被拦截嗅探  到了1999年，SSL协议 因为应用广泛，已经成为互联网上的标准.  后来SSL协议 又被 IETF组织 标准化，标准化之后的名字叫做 TLS （Transport L">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://i4.tietuku.com/c4871d1906fcfa4c.png">
<meta property="og:image" content="http://i4.tietuku.com/7711162216ef1f52.jpg">
<meta property="og:updated_time" content="2019-04-08T14:35:32.841Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTPS、SSL与TLS">
<meta name="twitter:description" content="首先 SSL与TLS都是一种接口标准. SSL协议 与 TLS协议 的关系 SSL 是洋文Secure Sockets Layer的缩写，中文叫做 安全套接层  SSL协议解决http协议使用明文方式传输数据，防止数据被拦截嗅探  到了1999年，SSL协议 因为应用广泛，已经成为互联网上的标准.  后来SSL协议 又被 IETF组织 标准化，标准化之后的名字叫做 TLS （Transport L">
<meta name="twitter:image" content="http://i4.tietuku.com/c4871d1906fcfa4c.png">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/courage.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/courage.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="次元空间" title="次元空间"></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="次元空间">次元空间</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">异世界的大门</a></li>
					
						<li><a href="/archives">档案岛</a></li>
					
						<li><a href="/about">AboutMe</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search">
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</ul></nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/09/19/HTTPS、SSL与TLS/" title="HTTPS、SSL与TLS" itemprop="url">HTTPS、SSL与TLS</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="terriermon" target="_blank" itemprop="author">terriermon</a>
		
  </p><p class="article-time">
    <time datetime="2017-09-19T05:05:10.000Z" itemprop="datePublished"> Published 2017-09-19</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#首先-SSL与TLS都是一种接口标准"><span class="toc-number">1.</span> <span class="toc-text">首先 SSL与TLS都是一种接口标准.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL协议-与-TLS协议-的关系"><span class="toc-number">2.</span> <span class="toc-text">SSL协议 与 TLS协议 的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL（Secure-Sockets-Layer-安全套接层）能够做的事情"><span class="toc-number">3.</span> <span class="toc-text">SSL（Secure Sockets Layer 安全套接层）能够做的事情</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL（Secure-Sockets-Layer-安全套接层）处于网络模型中哪个层次？"><span class="toc-number">4.</span> <span class="toc-text">SSL（Secure Sockets Layer 安全套接层）处于网络模型中哪个层次？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#首先看下TCP-IP的四个分层结构"><span class="toc-number">4.1.</span> <span class="toc-text">首先看下TCP/IP的四个分层结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP协议-与-TCP协议-的关系"><span class="toc-number">4.2.</span> <span class="toc-text">HTTP协议 与 TCP协议 的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP协议默认是明文传输数据，不会对传输的数据加密保护"><span class="toc-number">4.3.</span> <span class="toc-text">HTTP协议默认是明文传输数据，不会对传输的数据加密保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#而SSL协议作为提供了-1-传输数据加密保护，2-身份验证，3-传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）"><span class="toc-number">4.4.</span> <span class="toc-text">而SSL协议作为提供了 1. 传输数据加密保护，2. 身份验证，3. 传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注意如图中的-应用层，使用的协议仍然是-http"><span class="toc-number">5.</span> <span class="toc-text">注意如图中的 应用层，使用的协议仍然是 http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#https与http数据传输方式的区别"><span class="toc-number">6.</span> <span class="toc-text">https与http数据传输方式的区别:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#所以严格来说，https-并不是一种通信协议，只是异类的通信方式"><span class="toc-number">7.</span> <span class="toc-text">所以严格来说，https 并不是一种通信协议，只是异类的通信方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#我对HTTPS的理解-HTTPS-形式的URL访问，是SSL层的入口，应用层-gt-SSL层-gt-传输层"><span class="toc-number">8.</span> <span class="toc-text">我对HTTPS的理解: HTTPS://形式的URL访问，是SSL层的入口，应用层-&gt;SSL层-&gt;传输层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#我对HTTP的理解-无法经过SSL，直接是-应用层-gt-传输层"><span class="toc-number">9.</span> <span class="toc-text">我对HTTP的理解: 无法经过SSL，直接是 应用层-&gt;传输层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据"><span class="toc-number">10.</span> <span class="toc-text">数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端与服务端使用https通信的简化过程"><span class="toc-number">11.</span> <span class="toc-text">客户端与服务端使用https通信的简化过程:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL缺点"><span class="toc-number">12.</span> <span class="toc-text">SSL缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL证书是什么"><span class="toc-number">13.</span> <span class="toc-text">SSL证书是什么?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL证书验证"><span class="toc-number">14.</span> <span class="toc-text">SSL证书验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL证书校验过程"><span class="toc-number">15.</span> <span class="toc-text">SSL证书校验过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如上过程的关键点-证书颁发机构CA-根证书的-公钥"><span class="toc-number">16.</span> <span class="toc-text">如上过程的关键点: 证书颁发机构CA 根证书的 公钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL-Pinning"><span class="toc-number">17.</span> <span class="toc-text">SSL Pinning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#直接对比两个证书就能够安全验证服务端与客户端吗？"><span class="toc-number">18.</span> <span class="toc-text">直接对比两个证书就能够安全验证服务端与客户端吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#所以只要是使用权威CA结机构颁发的证书绝对是安全的"><span class="toc-number">19.</span> <span class="toc-text">所以只要是使用权威CA结机构颁发的证书绝对是安全的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要用SSL-Pinning"><span class="toc-number">20.</span> <span class="toc-text">为什么要用SSL Pinning?</span></a></li></ol>
		
		</div>
		
		<h3 id="首先-SSL与TLS都是一种接口标准"><a href="#首先-SSL与TLS都是一种接口标准" class="headerlink" title="首先 SSL与TLS都是一种接口标准."></a>首先 SSL与TLS都是一种接口标准.</h3><hr>
<h3 id="SSL协议-与-TLS协议-的关系"><a href="#SSL协议-与-TLS协议-的关系" class="headerlink" title="SSL协议 与 TLS协议 的关系"></a>SSL协议 与 TLS协议 的关系</h3><ul>
<li><p>SSL 是洋文<code>Secure Sockets Layer</code>的缩写，中文叫做 <code>安全套接层</code></p>
</li>
<li><p>SSL协议解决http协议使用<code>明文</code>方式传输数据，防止数据被拦截嗅探</p>
</li>
<li><p>到了1999年，SSL协议 因为应用广泛，已经成为互联网上的标准.</p>
</li>
<li><p>后来SSL协议 又被 IETF组织 标准化，标准化之后的名字叫做 <code>TLS （Transport Layer Security）</code>，中文叫做“传输层安全协议”.</p>
</li>
<li><p>所以 SSL协议与TLS协议实际上是同一个东西，只是不同的阶段标准化名.</p>
</li>
</ul>
<hr>
<h3 id="SSL（Secure-Sockets-Layer-安全套接层）能够做的事情"><a href="#SSL（Secure-Sockets-Layer-安全套接层）能够做的事情" class="headerlink" title="SSL（Secure Sockets Layer 安全套接层）能够做的事情"></a>SSL（Secure Sockets Layer 安全套接层）能够做的事情</h3><ul>
<li>事情一、对传输的数据保密</li>
<li>让 <code>数据发送者</code> 和 <code>数据接收者</code> 互相进行认证</li>
<li><p>确保数据发送到正确的<code>客户端</code>和<code>服务器</code></p>
</li>
<li><p>事情二、身份认证</p>
</li>
<li>可选的 客户端 认证</li>
<li><p>强制的 服务端 认证</p>
</li>
<li><p>事情三、维护传输数据的完整性</p>
</li>
<li>维护数据的<code>完整性 或 防止篡改</code>，确保数据在传输过程中不被改变</li>
<li>一旦发现数据被篡改，就会自动断开网络连接</li>
</ul>
<hr>
<h3 id="SSL（Secure-Sockets-Layer-安全套接层）处于网络模型中哪个层次？"><a href="#SSL（Secure-Sockets-Layer-安全套接层）处于网络模型中哪个层次？" class="headerlink" title="SSL（Secure Sockets Layer 安全套接层）处于网络模型中哪个层次？"></a>SSL（Secure Sockets Layer 安全套接层）处于网络模型中哪个层次？</h3><h4 id="首先看下TCP-IP的四个分层结构"><a href="#首先看下TCP-IP的四个分层结构" class="headerlink" title="首先看下TCP/IP的四个分层结构"></a>首先看下TCP/IP的四个分层结构</h4><p><img src="http://i4.tietuku.com/c4871d1906fcfa4c.png" alt></p>
<h4 id="HTTP协议-与-TCP协议-的关系"><a href="#HTTP协议-与-TCP协议-的关系" class="headerlink" title="HTTP协议 与 TCP协议 的关系"></a>HTTP协议 与 TCP协议 的关系</h4><ul>
<li>HTTP协议 属于 <code>应用层</code> 最顶端的传输协议，短连接</li>
<li>TCP协议 属于 <code>传输层</code> 靠下层的传输协议，长连接</li>
<li>所以说 HTTP协议 是构建于 TCP协议 之上的，并且一次连接之后主动做一次断开操作，形成短连接</li>
</ul>
<h4 id="HTTP协议默认是明文传输数据，不会对传输的数据加密保护"><a href="#HTTP协议默认是明文传输数据，不会对传输的数据加密保护" class="headerlink" title="HTTP协议默认是明文传输数据，不会对传输的数据加密保护"></a>HTTP协议默认是<code>明文</code>传输数据，不会对传输的数据<code>加密保护</code></h4><h4 id="而SSL协议作为提供了-1-传输数据加密保护，2-身份验证，3-传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）"><a href="#而SSL协议作为提供了-1-传输数据加密保护，2-身份验证，3-传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）" class="headerlink" title="而SSL协议作为提供了 1. 传输数据加密保护，2. 身份验证，3. 传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）"></a>而SSL协议作为提供了 <code>1. 传输数据加密保护</code>，<code>2. 身份验证</code>，<code>3. 传输数据完整性</code>的安全数据传输。并且出现在一个<code>单独的套接层</code>（传输层）</h4><ul>
<li>原始TCP/IP四层结构中，应用层 直接将 <code>明文数据</code> 传递给 传输层</li>
<li><p>网络上传输的全是明文数据</p>
</li>
<li><p>而加入 <code>SSL安全套接层</code> 之后</p>
</li>
<li>应用层HTTP协议 先将 <code>明文数据</code> 传递给 <code>SSL安全套接层</code></li>
<li>由 SSL安全套接层 对明文数据进行 加密保护、以及双方身份验证，对数据进行安全处理</li>
<li>最后由 SSL安全套接层 <code>将处理过的加密数据</code> 发送给 传输层</li>
</ul>
<p>所以传输层收到的是一个 <code>处理过的加密数据</code> ，那么最终在网络上传输的数据也就是这个<code>加密处理后的数据</code>。</p>
<p><img src="http://i4.tietuku.com/7711162216ef1f52.jpg" alt></p>
<h3 id="注意如图中的-应用层，使用的协议仍然是-http"><a href="#注意如图中的-应用层，使用的协议仍然是-http" class="headerlink" title="注意如图中的 应用层，使用的协议仍然是 http"></a>注意如图中的 <code>应用层</code>，使用的协议仍然是 <code>http</code></h3><hr>
<h3 id="https与http数据传输方式的区别"><a href="#https与http数据传输方式的区别" class="headerlink" title="https与http数据传输方式的区别:"></a><code>https</code>与<code>http</code>数据传输方式的区别:</h3><ul>
<li><p>最终 <code>应用层</code> 仍然是使用 <code>http协议</code></p>
</li>
<li><p>识别到时<code>https://</code>，那么走特定的端口 443，表示需要 <code>进入SSL安全套接层加密处理</code></p>
</li>
<li><p>那么现在就不会像以前直接 <code>应用层 ----&gt; 传输层</code></p>
</li>
<li><p>而是中间多出了一个SSL层处理，<code>应用层 -----&gt; SSL层 -----&gt; 传输层</code></p>
</li>
<li><p>SSL层负责对传输数据的<code>加密、完整性验证、双方身份认证</code></p>
</li>
</ul>
<hr>
<h3 id="所以严格来说，https-并不是一种通信协议，只是异类的通信方式"><a href="#所以严格来说，https-并不是一种通信协议，只是异类的通信方式" class="headerlink" title="所以严格来说，https 并不是一种通信协议，只是异类的通信方式"></a>所以严格来说，<code>https 并不是一种通信协议</code>，只是异类的<code>通信方式</code></h3><ul>
<li>https 只是对 应用层http协议 <code>扩展</code> </li>
<li><code>应用层</code> 仍然是使用 <code>http</code>协议 进行数据传输</li>
<li>只是<code>https</code>形式的URL访问，会 <code>额外的 经过 SSL层 进行加密处理</code></li>
</ul>
<h3 id="我对HTTPS的理解-HTTPS-形式的URL访问，是SSL层的入口，应用层-gt-SSL层-gt-传输层"><a href="#我对HTTPS的理解-HTTPS-形式的URL访问，是SSL层的入口，应用层-gt-SSL层-gt-传输层" class="headerlink" title="我对HTTPS的理解: HTTPS://形式的URL访问，是SSL层的入口，应用层-&gt;SSL层-&gt;传输层"></a>我对HTTPS的理解: <code>HTTPS://形式的URL访问，是SSL层的入口，应用层-&gt;SSL层-&gt;传输层</code></h3><h3 id="我对HTTP的理解-无法经过SSL，直接是-应用层-gt-传输层"><a href="#我对HTTP的理解-无法经过SSL，直接是-应用层-gt-传输层" class="headerlink" title="我对HTTP的理解: 无法经过SSL，直接是 应用层-&gt;传输层"></a>我对HTTP的理解: <code>无法经过SSL，直接是 应用层-&gt;传输层</code></h3><hr>
<h3 id="数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据"><a href="#数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据" class="headerlink" title="数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据"></a>数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据</h3><ul>
<li>就是一个很小的计算机文件</li>
<li>用于在SSL协议基础上在客户端与服务端数据传输通道上进行<code>安全认证</code></li>
<li>作用类似于我们的身份证、护照，用于证明身份（来区分合法请求或非法请求），类似一种 <code>签名</code>，能够 证明 这个机构或人的 <code>身份的真实性</code></li>
<li>SSL安全传输主要基于此实现</li>
</ul>
<hr>
<h3 id="客户端与服务端使用https通信的简化过程"><a href="#客户端与服务端使用https通信的简化过程" class="headerlink" title="客户端与服务端使用https通信的简化过程:"></a>客户端与服务端使用https通信的简化过程:</h3><ul>
<li>客户端和服务端建立一个连接，服务端 返回给 客户端 一个证书（注意:只包含<code>公钥</code>）</li>
<li><p>客户端由苹果预先存放了 所有受信任颁发证书机构的 <code>根证书</code></p>
</li>
<li><p>客户端使用这个 <code>根证书</code> 对 <code>服务端返回的证书（公钥）</code> 进行验证</p>
</li>
<li><p>如果 验证证书 是可信任的，就生成一个 pre-master secret</p>
</li>
<li><p>使用之前服务端返回证书（公钥）的 公钥 对这个 pre-master secret 加密</p>
</li>
<li><p>将加密后的 pre-master secret 再发送给 服务端</p>
</li>
<li><p>服务端接收到加密的之后，使用 证书私钥 解密 pre-master secret</p>
</li>
<li><p>再根据某种算法生成 master secret</p>
</li>
<li><p>可能是对称加密，确保<code>对称</code>加密的复杂性</p>
</li>
<li><p>客户端也同样根据这种算法从 pre-master secret 生成 master secret</p>
</li>
<li><p>随后双方的通信都用这个 master secret 对传输数据进行加密解密</p>
</li>
<li><p>如果 验证证书 不是信任的，则会弹出警告提示或终止请求</p>
</li>
</ul>
<hr>
<h3 id="SSL缺点"><a href="#SSL缺点" class="headerlink" title="SSL缺点"></a>SSL缺点</h3><ul>
<li>SSL协议需要在握手之前<code>建立TCP连接</code>，因此<code>不能对UDP</code>应用进行保护</li>
<li>每一次都会身份验证，可能会造成一定性能的下降</li>
</ul>
<hr>
<h3 id="SSL证书是什么"><a href="#SSL证书是什么" class="headerlink" title="SSL证书是什么?"></a>SSL证书是什么?</h3><ul>
<li>是上面提到的 数字证书 的一种</li>
<li>遵循 SSL协议 规定</li>
<li>由 受信任的数字证书颁发机构CA（如GlobalSign，wosign），在<code>验证服务器身份</code>后颁发</li>
<li>在 <code>服务器身份验证</code> 和 数据传输加密 的过程中，扮演了不可获取的角色（也就是说借助了SSL证书完成安全传输）</li>
</ul>
<hr>
<h3 id="SSL证书验证"><a href="#SSL证书验证" class="headerlink" title="SSL证书验证"></a>SSL证书验证</h3><ul>
<li>服务端身份验证</li>
<li>验证方法一、使用<code>客户端 内置</code>的受信任CA机构的<code>根证书</code>进行验证服务端发送过来的SSL证书</li>
<li>验证方法二、使用<code>客户端 绑定的本地证书</code>验证</li>
<li>1）验证证书的公钥是否一致</li>
<li><p>2）先验证服务端证书的合法性，再验证证书内容是否一致</p>
</li>
<li><p>客户端身份验证</p>
</li>
<li>服务端对客户端发送过来的证书进行验证，看是否是合法用户</li>
</ul>
<hr>
<h3 id="SSL证书校验过程"><a href="#SSL证书校验过程" class="headerlink" title="SSL证书校验过程"></a>SSL证书校验过程</h3><ul>
<li><p>一个证书颁发机构(CA)，颁发了一个证书A，服务器用这个证书A建立https连接与客户端传输数据</p>
</li>
<li><p>客户端 在信任列表里有这个CA机构的根证书</p>
</li>
<li><p>证书A里包含有证书内容F，以及使用证书A中的私钥 加密后的内容F1</p>
</li>
<li><p>建立https连接时，服务端 发送证书A 给 客户端</p>
</li>
<li><p>客户端 的系统里的 CA机构根证书 有这个CA机构的 公钥</p>
</li>
<li><p>客户端 用这个 公钥 对 证书A中的加密内容F1 解密得到 F2</p>
</li>
<li><p>客户端 判断 F2 与 证书A中的F 是否一致，若相等就通过验证</p>
</li>
</ul>
<hr>
<h3 id="如上过程的关键点-证书颁发机构CA-根证书的-公钥"><a href="#如上过程的关键点-证书颁发机构CA-根证书的-公钥" class="headerlink" title="如上过程的关键点: 证书颁发机构CA 根证书的 公钥"></a>如上过程的关键点: <code>证书颁发机构CA 根证书的 公钥</code></h3><ul>
<li><p>CA机构根证书 的 公钥，是预先存放到 客户端系统中，其他中间人根本无法获取到这个 公钥</p>
</li>
<li><p>无法获取这个 公钥，也就无法 解密 服务端发送过来的证书A中的 F1，那么最终也就无法通过验证</p>
</li>
</ul>
<hr>
<h3 id="SSL-Pinning"><a href="#SSL-Pinning" class="headerlink" title="SSL Pinning"></a>SSL Pinning</h3><ul>
<li><p>直接 SSL证书文件 保存在 客户端的代码中，程序运行时将证书文件读入内存</p>
</li>
<li><p>在之后的每一次https连接时，对比 服务端返回的 和 客户端保存 的两个证书是否一样</p>
</li>
<li>如果一致，表明证书是真的，不再去系统的 信任证书机构 里寻找 验证</li>
<li><p>如果不一致，就会断开连接</p>
</li>
<li><p>因为APP事先已经知道要进行 <code>通信的服务端 host</code>，可以直接在 客户端保存这个服务端的SSL证书 用于校验</p>
</li>
</ul>
<hr>
<h3 id="直接对比两个证书就能够安全验证服务端与客户端吗？"><a href="#直接对比两个证书就能够安全验证服务端与客户端吗？" class="headerlink" title="直接对比两个证书就能够安全验证服务端与客户端吗？"></a>直接对比两个证书就能够安全验证服务端与客户端吗？</h3><ul>
<li>如果 中间人 从 <code>客户端</code> 取出 证书</li>
<li>再 伪装成 服务端 跟其他 客户端 通信</li>
<li>然后将 证书 发送给 客户端</li>
<li>客户端此时对比本地证书 确实是一致 ，可以通过验证</li>
<li>客户端对要发送给服务端的数据，使用 证书中的公钥 加密，然后发送给服务端</li>
<li>然后被中间人再次拦截，取出证书，但是无法解密传输的数据</li>
<li>因为解密传输的数据，需要证书中的 <code>私钥</code></li>
<li><strong>证书的私钥，唯一存放在 服务端，不会在网络上传播</strong></li>
<li>所以即使拦截到证书也无法解密拦截到的数据</li>
</ul>
<h3 id="所以只要是使用权威CA结机构颁发的证书绝对是安全的"><a href="#所以只要是使用权威CA结机构颁发的证书绝对是安全的" class="headerlink" title="所以只要是使用权威CA结机构颁发的证书绝对是安全的"></a>所以只要是使用权威CA结机构颁发的证书绝对是安全的</h3><hr>
<h3 id="为什么要用SSL-Pinning"><a href="#为什么要用SSL-Pinning" class="headerlink" title="为什么要用SSL Pinning?"></a>为什么要用SSL Pinning?</h3><ul>
<li>因为从CA机构 申请颁发证书 价格比较昂贵</li>
<li>小企业或个人用户可能会选择 自己作为证书颁发机构CA 自己颁发证书</li>
<li>但是 自己颁发的证书 无法通过 客户端系统中受信任的CA机构列表 验证</li>
<li>需要 SSL Pinning 这样的方式，去对比本地的SSL证书是否一致即可.</li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2017/09/19/HTTPS、SSL与TLS/" data-title="HTTPS、SSL与TLS | 次元空间" data-tsina class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/2017/09/23/自定义NSOperation子类/" title="自定义NSOperation子类">
  <strong>上一篇：</strong><br>
  <span>
  自定义NSOperation子类</span>
</a>
</div>


<div class="next">
<a href="/2017/09/19/HTTPS-基本工作原理/" title="HTTPS 基本工作原理">
 <strong>下一篇：</strong><br> 
 <span>HTTPS 基本工作原理
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2017/09/19/HTTPS、SSL与TLS/" data-title="HTTPS、SSL与TLS" data-url="http://yoursite.com/2017/09/19/HTTPS、SSL与TLS/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#首先-SSL与TLS都是一种接口标准"><span class="toc-number">1.</span> <span class="toc-text">首先 SSL与TLS都是一种接口标准.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL协议-与-TLS协议-的关系"><span class="toc-number">2.</span> <span class="toc-text">SSL协议 与 TLS协议 的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL（Secure-Sockets-Layer-安全套接层）能够做的事情"><span class="toc-number">3.</span> <span class="toc-text">SSL（Secure Sockets Layer 安全套接层）能够做的事情</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL（Secure-Sockets-Layer-安全套接层）处于网络模型中哪个层次？"><span class="toc-number">4.</span> <span class="toc-text">SSL（Secure Sockets Layer 安全套接层）处于网络模型中哪个层次？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#首先看下TCP-IP的四个分层结构"><span class="toc-number">4.1.</span> <span class="toc-text">首先看下TCP/IP的四个分层结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP协议-与-TCP协议-的关系"><span class="toc-number">4.2.</span> <span class="toc-text">HTTP协议 与 TCP协议 的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP协议默认是明文传输数据，不会对传输的数据加密保护"><span class="toc-number">4.3.</span> <span class="toc-text">HTTP协议默认是明文传输数据，不会对传输的数据加密保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#而SSL协议作为提供了-1-传输数据加密保护，2-身份验证，3-传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）"><span class="toc-number">4.4.</span> <span class="toc-text">而SSL协议作为提供了 1. 传输数据加密保护，2. 身份验证，3. 传输数据完整性的安全数据传输。并且出现在一个单独的套接层（传输层）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注意如图中的-应用层，使用的协议仍然是-http"><span class="toc-number">5.</span> <span class="toc-text">注意如图中的 应用层，使用的协议仍然是 http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#https与http数据传输方式的区别"><span class="toc-number">6.</span> <span class="toc-text">https与http数据传输方式的区别:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#所以严格来说，https-并不是一种通信协议，只是异类的通信方式"><span class="toc-number">7.</span> <span class="toc-text">所以严格来说，https 并不是一种通信协议，只是异类的通信方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#我对HTTPS的理解-HTTPS-形式的URL访问，是SSL层的入口，应用层-gt-SSL层-gt-传输层"><span class="toc-number">8.</span> <span class="toc-text">我对HTTPS的理解: HTTPS://形式的URL访问，是SSL层的入口，应用层-&gt;SSL层-&gt;传输层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#我对HTTP的理解-无法经过SSL，直接是-应用层-gt-传输层"><span class="toc-number">9.</span> <span class="toc-text">我对HTTP的理解: 无法经过SSL，直接是 应用层-&gt;传输层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据"><span class="toc-number">10.</span> <span class="toc-text">数字证书、将一些在验证身份时候需要的一些数据项，通过服务器私钥进行加密后的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端与服务端使用https通信的简化过程"><span class="toc-number">11.</span> <span class="toc-text">客户端与服务端使用https通信的简化过程:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL缺点"><span class="toc-number">12.</span> <span class="toc-text">SSL缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL证书是什么"><span class="toc-number">13.</span> <span class="toc-text">SSL证书是什么?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL证书验证"><span class="toc-number">14.</span> <span class="toc-text">SSL证书验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL证书校验过程"><span class="toc-number">15.</span> <span class="toc-text">SSL证书校验过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如上过程的关键点-证书颁发机构CA-根证书的-公钥"><span class="toc-number">16.</span> <span class="toc-text">如上过程的关键点: 证书颁发机构CA 根证书的 公钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL-Pinning"><span class="toc-number">17.</span> <span class="toc-text">SSL Pinning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#直接对比两个证书就能够安全验证服务端与客户端吗？"><span class="toc-number">18.</span> <span class="toc-text">直接对比两个证书就能够安全验证服务端与客户端吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#所以只要是使用权威CA结机构颁发的证书绝对是安全的"><span class="toc-number">19.</span> <span class="toc-text">所以只要是使用权威CA结机构颁发的证书绝对是安全的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么要用SSL-Pinning"><span class="toc-number">20.</span> <span class="toc-text">为什么要用SSL Pinning?</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  

  

  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
    </ul>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer">
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 业精于勤而荒于嬉，行成于思而毁于随 <br>
			天空不曾流过痕迹，但鸟儿已飞过天空</p>
	</section>
	 
	<div class="social-font">
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:codermoe@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="terriermon">terriermon</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"codermoe"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 









<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-77667620-1', '');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
